(()=>{"use strict";const e=()=>fetch("./dbHeroes.json").then((e=>e.json())).catch((e=>console.log(e.message))),t=e=>[...new Set(e)],o=({timing:e,draw:t,duration:o})=>{let n=performance.now();requestAnimationFrame((function l(i){let s=(i-n)/o;s>1&&(s=1);let r=e(s);t(r),s<1&&requestAnimationFrame(l)}))},n=e=>{const t=document.getElementById("list-movies");if(e){let o=document.createElement("li");o.textContent=e,o.classList.add("list-movies-item"),t.append(o)}},l=(o="")=>{document.getElementById("list-movies").innerHTML="";let l=[];e().then((e=>{e.forEach((e=>{e.movies&&(l=[...l,...e.movies])})),l=t(l),""===o||(l=l.filter((e=>{if(e.toLowerCase().includes(o.toLowerCase()))return e}))),l.forEach((e=>{n(e)}))})).catch((e=>console.log(e.message)))},i=o=>{const n=document.getElementById(o);let l=[];e().then((e=>{e.forEach((e=>{e[o]&&l.push(e[o])})),l=t(l),l.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,n.append(t)}))}))},s=e=>{const t=document.querySelector(".hero-block"),o=document.createElement("div");o.className="hero-slide";const n=document.createElement("div");n.className="hero-image";const l=document.createElement("div");l.className="hero-info";for(let t in e)if("photo"===t)n.innerHTML=`<img src=${"./"+e[t]} alt="hero" class="hero-img">`;else if(e[t]){const o=document.createElement("div");o.className="hero-info-item";const n=document.createElement("div");n.className="hero-info-item-title",n.textContent=t,o.append(n);const i=document.createElement("div");i.className="hero-info-item-text",i.textContent=e[t],o.append(i),l.append(o)}o.append(n),o.append(l),t.append(o)},r=()=>{const e=document.querySelector(".hero-wrapper"),t=(e.querySelector(".hero-block"),e.querySelectorAll(".arrow")),n=e.querySelector(".pagination"),l=n.querySelector(".counter-current"),i=n.querySelector(".counter-total");let s=e.querySelectorAll(".hero-slide"),r=0;i.textContent=s.length,l.textContent=r+1,n.style="",t.forEach((e=>{e.style=""})),e.addEventListener("click",(t=>{t.target.closest(".button-next")&&(s=e.querySelectorAll(".hero-slide"),r++,r>=s.length&&(r=0),s.forEach((e=>{e.style.display="none"})),s[r].style="opacity: 0",s[r].style="display: flex",o({duration:500,timing:e=>e,draw(e){s[r].style.opacity=e}}),l.textContent=r+1),t.target.closest(".button-prev")&&(s=e.querySelectorAll(".hero-slide"),r--,r<0&&(r=s.length-1),s.forEach((e=>{e.style.display="none"})),s[r].style.opacity="0",s[r].style.display="flex",o({duration:500,timing:e=>e,draw(e){s[r].style.opacity=e}}),l.textContent=r+1)}))},c=t=>{const o=document.querySelector(".hero-wrapper"),n=o.querySelector(".hero-block"),l=o.querySelectorAll(".arrow"),i=o.querySelector(".pagination");e().then((e=>{t.species&&(e=e.filter((e=>e.species===t.species))),t.gender&&(e=e.filter((e=>e.gender===t.gender))),t.status&&(e=e.filter((e=>e.status===t.status))),t.citizenship&&(e=e.filter((e=>e.citizenship===t.citizenship))),t.movie&&("All films"===t.movie||(e=e.filter((e=>{if(e.movies&&e.movies.includes(t.movie))return e})))),n.innerHTML="",0===e.length?(i.style.display="none",l.forEach((e=>{e.style.display="none"})),n.innerHTML='\n            <div style = "position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; font-size: 1.5rem; width: 100%">\n            Нет данных по вашему запросу, измените значения фильтров</div>\n            '):(e.forEach((e=>{e&&s(e)})),r())}))};e(),l(),i(),["species","gender","status","citizenship"].forEach((e=>{i(e)})),n(),e().then((e=>{e.forEach((e=>{e&&s(e)})),r()})),(()=>{const e=document.getElementById("list-movies"),t=e.getElementsByTagName("li"),o=document.querySelectorAll("select"),n=document.querySelector(".title-hero");let l={};e.addEventListener("click",(e=>{if(e.target.closest(".list-movies-item")){for(let e of t)e.classList.remove("list-movies-item-active");e.target.classList.add("list-movies-item-active"),n.textContent=e.target.textContent,o.forEach((e=>{l[e.id]=e.value})),l.movie=e.target.textContent,c(l)}}))})(),(()=>{const e=document.getElementById("list-movies").getElementsByTagName("li"),t=document.querySelectorAll("select");let o={};t.forEach((n=>{n.addEventListener("change",(()=>{t.forEach((e=>{o[e.id]=e.value}));for(let t of e)t.classList.contains("list-movies-item-active")&&(o.movie=t.textContent);c(o)}))}))})(),r(),(()=>{const e=document.querySelector(".search-input");e.addEventListener("input",(()=>{l(e.value)}))})()})();